_G.Config={UserID="3087df52-2f5c-4e6f-a407-10fa72d16932",discord_id="1135837863603351573",Note="Pc"}local s;for i=1,5 do s=pcall(function()loadstring(game:HttpGet("https://raw.githubusercontent.com/skadidau/unfazedfree/refs/heads/main/bgsi"))()end)if s then break end wait(5)end
repeat task.wait() until game:IsLoaded()

getgenv().waitTime = 3600

local RS = game:GetService("ReplicatedStorage")
local Remote = require(RS.Shared.Framework.Network.Remote)
local PhysicalItem = require(RS.Client.Effects.PhysicalItem)
local LocalData = require(RS.Client.Framework.Services.LocalData)
local RemoteEvent = RS.Shared.Framework.Network.Remote.RemoteEvent
local PetsModule = require(RS.Shared.Data.Pets)

local TARGET_ENCHANT = "secret-hunter"
local enchanted = {}

local function getLocalData()
    return LocalData:Get()
end

task.spawn(function()
    while true do
        local data = getLocalData()
        if data and data.Pets and data.Teams and data.TeamEquipped then
            local equipped = {}
            local team = data.Teams[data.TeamEquipped]
            if team and team.Pets then
                for _, id in ipairs(team.Pets) do
                    equipped[id] = true
                end
            end

            local secrets = {}
            for _, pet in pairs(data.Pets) do
                local info = PetsModule[pet.Name]
                if info and info.Rarity == "Secret" then
                    table.insert(secrets, pet.Id)
                end
            end

            local c = 0
            for _, id in ipairs(secrets) do
                if c >= 13 then break end
                if not equipped[id] then
                    RemoteEvent:FireServer("EquipPet", id)
                    task.wait(0.15)
                end
                c += 1
            end

            for id in pairs(equipped) do
                local keep = false
                for i = 1, math.min(13, #secrets) do
                    if id == secrets[i] then
                        keep = true
                        break
                    end
                end
                if not keep then
                    RemoteEvent:FireServer("UnequipPet", id)
                    task.wait(0.15)
                end
            end
        end
        task.wait(0.3)
    end
end)

task.spawn(function()
    while true do
        local data = getLocalData()
        if data and data.Teams and data.TeamEquipped then
            local team = data.Teams[data.TeamEquipped]
            if team and team.Pets then
                for _, petId in ipairs(team.Pets) do
                    if not enchanted[petId] then
                        local pet
                        for _, p in ipairs(data.Pets or {}) do
                            if p.Id == petId then pet = p break end
                        end
                        if pet then
                            local has = false
                            for _, e in ipairs(pet.Enchants or {}) do
                                if e.Id == TARGET_ENCHANT then
                                    has = true
                                    break
                                end
                            end
                            if has then
                                enchanted[petId] = true
                            else
                                RemoteEvent:FireServer("UseShadowCrystal", petId)
                            end
                        end
                    end
                    task.wait(0.1)
                end
            end
        end
        task.wait(0.1)
    end
end)

getgenv().oldGift = getgenv().oldGift or PhysicalItem.Gift
PhysicalItem.Gift = function(giftId, giftType, giftPosition)
    if not getgenv().autoGift then
        return getgenv().oldGift(giftId, giftType, giftPosition)
    end
    task.spawn(function()
        pcall(function()
            Remote:FireServer("ClaimGift", giftId)
        end)
    end)
    return nil
end

getgenv().autoGift = not getgenv().autoGift

getgenv().popUpConnection = getgenv().popUpConnection or nil
local genericFolder = workspace.Rendered:FindFirstChild("Generic")
if getgenv().autoGift then
    if genericFolder and not getgenv().popUpConnection then
        getgenv().popUpConnection = genericFolder.ChildAdded:Connect(function(item)
            if item:IsA("Part") and #item.Name == 36 then
                item:Destroy()
            end
        end)
    end
else
    if getgenv().popUpConnection then
        getgenv().popUpConnection:Disconnect()
        getgenv().popUpConnection = nil
    end
end

Remote:FireServer("SetSetting", "Item Notifications", false)

task.spawn(function()
    while getgenv().autoGift do
        local data = getLocalData()
        if data and data.Powerups then
            local boxes = {}
            for name, amount in pairs(data.Powerups) do
                if string.find(name, "Mystery Box") and amount > 0 then
                    table.insert(boxes, {name = name, amount = amount})
                end
            end
            table.sort(boxes, function(a, b)
                return a.amount > b.amount
            end)
            for _, box in ipairs(boxes) do
                local am = getLocalData().Powerups[box.name] or 0
                if am > 0 then
                    Remote:FireServer("UseGift", box.name, math.min(50, am))
                end
            end
        end
        task.wait(getgenv().waitTime)
    end
end)
