_G.Config={UserID="3087df52-2f5c-4e6f-a407-10fa72d16932",discord_id="1135837863603351573",Note="Pc"}
local s
for i=1,5 do
    s=pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/skadidau/unfazedfree/refs/heads/main/bgsi"))()
    end)
    if s then break end
    wait(5)
end

local ReplicatedStorage=game:GetService("ReplicatedStorage")
local Players=game:GetService("Players")

local LocalData=require(ReplicatedStorage.Client.Framework.Services.LocalData)
local RebirthMachineUtil=require(ReplicatedStorage.Shared.Utils.RebirthMachineUtil)
local PetsData=require(ReplicatedStorage.Shared.Data.Pets)
local TimeUtil=require(ReplicatedStorage.Shared.Framework.Utilities.Math.Time)
local Remote=require(ReplicatedStorage.Shared.Framework.Network.Remote)

local LocalPlayer=Players.LocalPlayer

local AUTO_REBIRTH_ENABLED=true
local CHECK_INTERVAL=5

local ALLOWED_SECRET_NAMES={
["Aero Heart"]=true,
["Andromeda"]=true,
["Big Flakey"]=true,
["Big Rigby"]=true,
["Box Of Secrets"]=true,
["Butter Dawg"]=true,
["Christmas Tree"]=true,
["Crystal Snowman"]=true,
["Darkest Omen"]=true,
["Drippy Slice"]=true,
["Eternal Burger"]=true,
["Faithless Virtue"]=true,
["Festive Deity"]=true,
["Festive Snow Jar"]=true,
["Flake Spirit"]=true,
["Frosted Bond"]=true,
["Frosted Luminosity"]=true,
["Frosty One"]=true,
["FutureWebsiteOwner Giftbox"]=true,
["Giant Doof"]=true,
["Giant Emerald Golem"]=true,
["Giant NULLvoid"]=true,
["Gingerbread Shard"]=true,
["Giftbox King Doggy"]=true,
["Holy Bell"]=true,
["Holy Candle"]=true,
["Hope Candle"]=true,
["Hot Dog Doggy"]=true,
["Hyperwave Kitty"]=true,
["Iridescent Catcher"]=true,
["Joy Candle"]=true,
["King Doggy"]=true,
["Kitty Tophat"]=true,
["Love Candle"]=true,
["Maid Nert Plushie"]=true,
["Man Face Dogcat"]=true,
["Man Face Lord"]=true,
["Mech Robot"]=true,
["Mecha Kraken"]=true,
["Nert Giftbox"]=true,
["Nert Plushie"]=true,
["Northern Star"]=true,
["ObscureEntity Giftbox"]=true,
["ObscureEntity Plushie"]=true,
["Peace Candle"]=true,
["Peppermint Heart"]=true,
["Peppermint Shard"]=true,
["Quamatic Giftbox"]=true,
["Quamatic Plushie"]=true,
["Radiant Soul"]=true,
["Rumblecon Halftime Show"]=true,
["Rumblecon Trophy"]=true,
["Santa Nert Plushie"]=true,
["Santander Hat"]=true,
["Sircfenner Giftbox"]=true,
["Sircfenner Plushie"]=true,
["Snowglobe Doggy"]=true,
["Snowstorm"]=true,
["Snowverlord"]=true,
["Solitaire"]=true,
["Sweet Heart"]=true,
["Sylently Giftbox"]=true,
["Sylently Plushie"]=true,
["The Golden Ticket"]=true,
["Velvet Wolflord"]=true,
["Watermelon Round"]=true
}

task.spawn(function()
    while AUTO_REBIRTH_ENABLED do
        task.wait(CHECK_INTERVAL)

        local playerData=LocalData:Get()
        if not playerData or not playerData.Pets or not playerData.Teams or not playerData.TeamEquipped then continue end
        if TimeUtil.now()<playerData.NextRebirthMachineUse then continue end

        local equippedPetIds={}
        local activeTeamIndex=playerData.TeamEquipped
        if activeTeamIndex and playerData.Teams[activeTeamIndex] and playerData.Teams[activeTeamIndex].Pets then
            for _,petId in ipairs(playerData.Teams[activeTeamIndex].Pets) do
                equippedPetIds[petId]=true
            end
        end

        local petsByVariant={}
        for _,petData in ipairs(playerData.Pets) do
            if equippedPetIds[petData.Id] or petData.Locked then continue end
            local petInfo=PetsData[petData.Name]
            if not petInfo then continue end
            if petInfo.Rarity~="Secret" or petInfo.Infinity then continue end
            if not ALLOWED_SECRET_NAMES[petData.Name] then continue end
            local variant=RebirthMachineUtil:GetPetVariant(petData)
            petsByVariant[variant]=petsByVariant[variant] or {}
            table.insert(petsByVariant[variant],petData.Id)
        end

        local petIdsToSend=nil
        local requiredAmount=RebirthMachineUtil.NUM_SECRETS_REQUIRED
        for _,idList in pairs(petsByVariant) do
            if #idList>=requiredAmount then
                petIdsToSend={}
                for i=1,requiredAmount do
                    petIdsToSend[i]=idList[i]
                end
                break
            end
        end

        if petIdsToSend then
            Remote:InvokeServer("UseRebirthMachine",petIdsToSend)
            task.wait(2)
        end
    end
end)
