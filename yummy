repeat task.wait() until game:IsLoaded()
local lp = game.Players.LocalPlayer
repeat task.wait() until lp:FindFirstChild("PlayerGui")
task.wait(math.random(0,3000)/1000) 
local g = lp.PlayerGui:FindFirstChild("ScreenGui")
if g and g:FindFirstChild("DailyRewards") then
    g.DailyRewards:Destroy()
end
task.wait(1)
-- ========= SERVICES =========
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local LocalData = require(ReplicatedStorage.Client.Framework.Services.LocalData)
local RemoteEvent = ReplicatedStorage.Shared.Framework.Network.Remote.RemoteEvent

if not firetouchinterest then return end

-- ========= HELPERS =========
local function getData()
    return LocalData:Get() or {}
end

local function getHRP()
    local char = player.Character or player.CharacterAdded:Wait()
    return char:WaitForChild("HumanoidRootPart")
end

-- ========= STEP 1: UNLOCK CHRISTMAS WORLD =========
local data = getData()
if not (data.WorldsUnlocked and data.WorldsUnlocked["Christmas World"]) then
    RemoteEvent:FireServer("UnlockWorld", "Christmas World")
    task.wait(6)
end

-- ========= STEP 2: TELEPORT TO CHRISTMAS WORLD =========
RemoteEvent:FireServer("WorldTeleport", "Christmas World")

-- ========= STEP 3: WAIT FOR ISLANDS =========
local function waitForIslands()
    while true do
        local world = Workspace.Worlds:FindFirstChild("Christmas World")
        if world and world:FindFirstChild("Islands") then
            return world.Islands
        end
        task.wait()
    end
end

local islandsFolder = waitForIslands()
local hrp = getHRP()

player.CharacterAdded:Connect(function()
    task.wait()
    hrp = getHRP()
end)

-- ========= STEP 4: CACHE ISLAND PARTS =========
local islandParts = {}

for _, isl in ipairs(islandsFolder:GetChildren()) do
    local island = isl:FindFirstChild("Island")
    if island then
        local part = island:FindFirstChildWhichIsA("BasePart", true)
        if part then
            islandParts[isl.Name] = part
        end
    end
end

-- ========= STEP 5: UNLOCK ISLANDS (SPAM UNTIL DONE) =========
local unlockConn
unlockConn = RunService.Heartbeat:Connect(function()
    local d = getData()
    local unlocked = d.AreasUnlocked or {}

    local working = false

    for name, part in pairs(islandParts) do
        if not unlocked[name] and hrp then
            firetouchinterest(hrp, part, 0)
            firetouchinterest(hrp, part, 1)
            working = true
        end
    end

    -- ========= STEP 6: ONLY WHEN DONE â†’ LOAD LOADER =========
    if not working then
        unlockConn:Disconnect()

        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/IdiotHub/Scripts/main/Loader"
        ))()
    end
end)
