repeat task.wait() until game:IsLoaded()
local lp = game.Players.LocalPlayer
repeat task.wait() until lp:FindFirstChild("PlayerGui")
task.wait(math.random(0,3000)/1000)

local g = lp.PlayerGui:FindFirstChild("ScreenGui")
if g and g:FindFirstChild("DailyRewards") then
    g.DailyRewards:Destroy()
end

getgenv().waitTime = 2.5

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Remote = require(ReplicatedStorage.Shared.Framework.Network.Remote)
local PhysicalItem = require(ReplicatedStorage.Client.Effects.PhysicalItem)
local LocalDataModule = require(ReplicatedStorage.Client.Framework.Services.LocalData)

function getLocalData()
    return LocalDataModule:Get()
end

getgenv().oldGift = getgenv().oldGift or PhysicalItem.Gift
PhysicalItem.Gift = function(giftId, giftType, giftPosition)
    if not getgenv().autoGift then return getgenv().oldGift(giftId, giftType, giftPosition) end
    task.spawn(function()
        pcall(function()
            Remote:FireServer("ClaimGift", giftId)
        end)
    end)
    return nil
end

getgenv().autoGift = true
getgenv().popUpConnection = getgenv().popUpConnection or nil

local genericFolder = workspace.Rendered:FindFirstChild("Generic")
if getgenv().autoGift then
    if genericFolder and not getgenv().popUpConnection then
        getgenv().popUpConnection = genericFolder.ChildAdded:Connect(function(item)
            if item:IsA("Part") and #item.Name == 36 then item:Destroy() end
        end)
    end
else
    if getgenv().popUpConnection then
        getgenv().popUpConnection:Disconnect()
        getgenv().popUpConnection = nil
    end
end

Remote:FireServer("SetSetting","Item Notifications",false)

-- OG Mystery Box Auto
task.spawn(function()
    while true do
        local powerups = getLocalData().Powerups
        for name, amount in pairs(powerups) do
            if name == "OG Mystery Box" and amount > 0 then
                local useAmount = (amount > 25 and 25 or amount)
                Remote:FireServer("UseGift", name, useAmount)
                task.wait(getgenv().waitTime)
            end
        end
        task.wait(1)
    end
end)

-- Eggs & Potions
task.spawn(function()
    local RemoteEvent = ReplicatedStorage:WaitForChild("Shared")
        :WaitForChild("Framework"):WaitForChild("Network")
        :WaitForChild("Remote"):WaitForChild("RemoteEvent")

    require(ReplicatedStorage.Client.Effects.HatchEgg).Play = function() return end

    local eggs = {"Season 7 Egg","Season 8 Egg","Season 9 Egg","Season OG Egg"}
    local potionTypes = {"Coins","Tickets"}
    local potionLevels = {1,2,3,4,5,6,7}

    task.spawn(function()
        while true do
            local eggToHatch = eggs[math.random(1,#eggs)]
            RemoteEvent:FireServer("HatchPowerupEgg", eggToHatch, 12)
            task.wait(0.5)
        end
    end)

    task.spawn(function()
        while true do
            local potionType = potionTypes[math.random(1,#potionTypes)]
            local potionLevel = potionLevels[math.random(1,#potionLevels)]
            RemoteEvent:FireServer("UsePotion", potionType, potionLevel, 10)
            task.wait(0.2)
        end
    end)
end)
