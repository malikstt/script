getgenv().waitTime = 2.5
getgenv().autoGift = true
getgenv().giftsToOpen = {
    "Admin Mystery Box",
}

local RS = game:GetService("ReplicatedStorage")
local Remote = require(RS.Shared.Framework.Network.Remote)
local PhysicalItem = require(RS.Client.Effects.PhysicalItem)
local LocalData = require(RS.Client.Framework.Services.LocalData)

local function getData()
    return LocalData:Get()
end

getgenv().oldGift = getgenv().oldGift or PhysicalItem.Gift
PhysicalItem.Gift = function(id, type, pos)
    if not getgenv().autoGift then
        return getgenv().oldGift(id, type, pos)
    end
    task.spawn(function()
        pcall(function()
            Remote:FireServer("ClaimGift", id)
        end)
    end)
    return nil
end

local genericFolder = workspace:WaitForChild("Rendered"):FindFirstChild("Generic")
getgenv().popUpConnection = getgenv().popUpConnection or nil

if genericFolder and not getgenv().popUpConnection then
    getgenv().popUpConnection = genericFolder.ChildAdded:Connect(function(i)
        if i:IsA("Part") and #i.Name == 36 then i:Destroy() end
    end)
end

Remote:FireServer("SetSetting","Item Notifications",false)

task.spawn(function()
    while getgenv().autoGift do
        for _,gift in pairs(getgenv().giftsToOpen) do
            local d = getData()
            if d and d.Powerups then
                local amt = d.Powerups[gift] or 0
                if amt > 0 then
                    Remote:FireServer("UseGift", gift, amt > 25 and 25 or amt)
                    task.wait(getgenv().waitTime)
                end
            end
        end
        task.wait(1)
    end
end)

task.spawn(function()
    local r = RS.Shared.Framework.Network.Remote.RemoteEvent
    while true do
        pcall(function()
            r:FireServer("HatchPowerupEgg","Prismatic Egg",1)
        end)
        task.wait(60)
    end
end)
