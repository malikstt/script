getgenv().waitTime = 25
getgenv().autoGift = true

repeat task.wait() until game:IsLoaded()

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local RemoteEvent = ReplicatedStorage
    :WaitForChild("Shared")
    :WaitForChild("Framework")
    :WaitForChild("Network")
    :WaitForChild("Remote")
    :WaitForChild("RemoteEvent")

local PhysicalItem = require(ReplicatedStorage.Client.Effects.PhysicalItem)
local LocalData = require(ReplicatedStorage.Client.Framework.Services.LocalData)

-- ================= TELEPORT FIRST =================
task.spawn(function()
    RemoteEvent:FireServer("UnlockWorld", "Minigame Paradise")
    task.wait(5)
    RemoteEvent:FireServer("WorldTeleport", "Minigame Paradise")
    repeat task.wait() until Workspace.Worlds:FindFirstChild("Minigame Paradise")
end)

-- ================= AUTO GIFT =================
getgenv().oldGift = getgenv().oldGift or PhysicalItem.Gift
PhysicalItem.Gift = function(giftId, giftType, giftPosition)
    if not getgenv().autoGift then
        return getgenv().oldGift(giftId, giftType, giftPosition)
    end
    task.spawn(function()
        pcall(function()
            RemoteEvent:FireServer("ClaimGift", giftId)
        end)
    end)
    return nil
end

-- ================= DELETE DROPPED GIFTS =================
local genericFolder = Workspace:WaitForChild("Rendered"):WaitForChild("Generic")
genericFolder.ChildAdded:Connect(function(item)
    if item:IsA("Part") and #item.Name == 36 then
        item:Destroy()
    end
end)

-- ================= USE MYSTERY BOX =================
task.spawn(function()
    while true do
        local data = LocalData:Get()
        if data and data.Powerups and (data.Powerups["Mystery Box"] or 0) > 0 then
            RemoteEvent:FireServer("UseGift", "Mystery Box", 50)
        end
        task.wait(getgenv().waitTime)
    end
end)

-- ================= RANDOM PET PIECE =================
task.spawn(function()
    while true do
        task.wait(10)
        local data = LocalData:Get()
        if data and data.Pets then
            local ids = {}
            for _, pet in pairs(data.Pets) do
                if pet.Id then
                    table.insert(ids, pet.Id)
                end
            end
            if #ids > 0 then
                RemoteEvent:FireServer("ChoosePiece", ids[math.random(#ids)])
            end
        end
        task.wait(120)
    end
end)

-- ================= BUY GUM =================
task.spawn(function()
    while true do
        RemoteEvent:FireServer("GumShopPurchase", "Void Gum")
        task.wait(1140)
    end
end)
