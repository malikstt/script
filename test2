local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalData = require(ReplicatedStorage.Client.Framework.Services.LocalData)

local player = Players.LocalPlayer

-- Create FULL SCREEN BLACK UI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ChristmasUnlockerUI"
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local BlackBackground = Instance.new("Frame")
BlackBackground.Name = "BlackBackground"
BlackBackground.Size = UDim2.new(1, 0, 1, 0)
BlackBackground.BackgroundColor3 = Color3.new(0, 0, 0)
BlackBackground.BackgroundTransparency = 0
BlackBackground.BorderSizePixel = 0
BlackBackground.Parent = ScreenGui

local Content = Instance.new("Frame")
Content.Name = "Content"
Content.Size = UDim2.new(1, 0, 1, 0)
Content.BackgroundTransparency = 1
Content.Parent = BlackBackground

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, 0, 0.1, 0)
Title.Position = UDim2.new(0, 0, 0.1, 0)
Title.BackgroundTransparency = 1
Title.Text = "üéÑ CHRISTMAS WORLD STATUS"
Title.TextColor3 = Color3.new(1, 1, 1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 32
Title.Parent = Content

local WorldStatus = Instance.new("TextLabel")
WorldStatus.Name = "WorldStatus"
WorldStatus.Size = UDim2.new(1, 0, 0.1, 0)
WorldStatus.Position = UDim2.new(0, 0, 0.2, 0)
WorldStatus.BackgroundTransparency = 1
WorldStatus.Text = "Christmas World Unlocked: checking..."
WorldStatus.TextColor3 = Color3.new(1, 1, 1)
WorldStatus.Font = Enum.Font.Gotham
WorldStatus.TextSize = 24
WorldStatus.Parent = Content

local IslandsContainer = Instance.new("ScrollingFrame")
IslandsContainer.Name = "IslandsContainer"
IslandsContainer.Size = UDim2.new(0.8, 0, 0.5, 0)
IslandsContainer.Position = UDim2.new(0.1, 0, 0.3, 0)
IslandsContainer.BackgroundTransparency = 1
IslandsContainer.ScrollBarThickness = 8
IslandsContainer.CanvasSize = UDim2.new(0, 0, 0, 0)
IslandsContainer.Parent = Content

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 8)
UIListLayout.Parent = IslandsContainer

local FullUnlockMessage = Instance.new("TextLabel")
FullUnlockMessage.Name = "FullUnlockMessage"
FullUnlockMessage.Size = UDim2.new(1, 0, 0.2, 0)
FullUnlockMessage.Position = UDim2.new(0, 0, 0.4, 0)
FullUnlockMessage.BackgroundTransparency = 1
FullUnlockMessage.Text = ""
FullUnlockMessage.TextColor3 = Color3.fromRGB(100, 255, 100)
FullUnlockMessage.Font = Enum.Font.GothamBold
FullUnlockMessage.TextSize = 36
FullUnlockMessage.Visible = false
FullUnlockMessage.Parent = Content

local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0.15, 0, 0.08, 0)
CloseButton.Position = UDim2.new(0.425, 0, 0.85, 0)
CloseButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
CloseButton.Text = "CLOSE"
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 20
CloseButton.Parent = Content

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Get Christmas World data
local christmasWorld = workspace.Worlds:FindFirstChild("Christmas World")
local islandsFolder = christmasWorld and christmasWorld:FindFirstChild("Islands")

-- Create island display items
local islandDisplays = {}
local allIslandNames = {}

if islandsFolder then
    for _, isl in ipairs(islandsFolder:GetChildren()) do
        local islandName = isl.Name
        
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(1, 0, 0, 40)
        frame.BackgroundTransparency = 1
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Size = UDim2.new(0.7, 0, 1, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = islandName
        nameLabel.TextColor3 = Color3.new(1, 1, 1)
        nameLabel.Font = Enum.Font.Gotham
        nameLabel.TextSize = 18
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        nameLabel.Parent = frame
        
        local statusLabel = Instance.new("TextLabel")
        statusLabel.Size = UDim2.new(0.3, 0, 1, 0)
        statusLabel.Position = UDim2.new(0.7, 0, 0, 0)
        statusLabel.BackgroundTransparency = 1
        statusLabel.Text = "checking..."
        statusLabel.TextColor3 = Color3.new(1, 1, 1)
        statusLabel.Font = Enum.Font.Gotham
        statusLabel.TextSize = 18
        statusLabel.TextXAlignment = Enum.TextXAlignment.Right
        statusLabel.Parent = frame
        
        frame.Parent = IslandsContainer
        islandDisplays[islandName] = statusLabel
        table.insert(allIslandNames, islandName)
    end
    
    IslandsContainer.CanvasSize = UDim2.new(0, 0, 0, #allIslandNames * 48)
end

-- Update function
local function updateDisplay()
    local data = LocalData:Get()
    
    -- Check Christmas World unlock
    local worldUnlocked = false
    if data then
        if data.WorldsUnlocked and data.WorldsUnlocked["Christmas World"] then
            worldUnlocked = true
        elseif data.UnlockedWorlds and data.UnlockedWorlds["Christmas World"] then
            worldUnlocked = true
        elseif data.Worlds and data.Worlds["Christmas World"] then
            worldUnlocked = true
        end
    end
    
    WorldStatus.Text = "Christmas World Unlocked: " .. (worldUnlocked and "‚úÖ TRUE" or "‚ùå FALSE")
    WorldStatus.TextColor3 = worldUnlocked and Color3.fromRGB(100, 255, 100) or Color3.fromRGB(255, 100, 100)
    
    -- Check island unlocks
    local allUnlocked = true
    local unlockedCount = 0
    
    local unlockedIslands = data and data.AreasUnlocked or {}
    
    for _, islandName in ipairs(allIslandNames) do
        local isUnlocked = unlockedIslands[islandName] and true or false
        local statusLabel = islandDisplays[islandName]
        
        if statusLabel then
            statusLabel.Text = isUnlocked and "‚úÖ TRUE" or "‚ùå FALSE"
            statusLabel.TextColor3 = isUnlocked and Color3.fromRGB(100, 255, 100) or Color3.fromRGB(255, 100, 100)
        end
        
        if isUnlocked then
            unlockedCount += 1
        else
            allUnlocked = false
        end
    end
    
    -- Check if everything is unlocked
    if worldUnlocked and allUnlocked then
        -- Hide all status displays
        WorldStatus.Visible = false
        IslandsContainer.Visible = false
        Title.Visible = false
        
        -- Show completion message
        FullUnlockMessage.Text = "üéâ CHRISTMAS WORLD IS 100% UNLOCKED !!"
        FullUnlockMessage.Visible = true
    else
        -- Show normal status
        WorldStatus.Visible = true
        IslandsContainer.Visible = true
        Title.Visible = true
        FullUnlockMessage.Visible = false
        
        -- Update title with progress
        Title.Text = string.format("üéÑ CHRISTMAS WORLD STATUS (%d/%d)", unlockedCount, #allIslandNames)
    end
end

-- Auto-update loop
task.spawn(function()
    while ScreenGui.Parent do
        updateDisplay()
        task.wait(1)  -- Update every second
    end
end)

-- Initial update
updateDisplay()
