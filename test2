local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local ws = workspace

local lp = Players.LocalPlayer
local char = lp and lp.Character
local worlds = ws:FindFirstChild("Worlds")
local cw = worlds and worlds:FindFirstChild("Christmas World")

local keep = {}
local function k(x) if x then keep[x] = true end end

k(ws.Camera)
k(worlds)
k(cw)
k(char)
local sp = cw and cw:FindFirstChild("Spawn")
local pp = cw and cw:FindFirstChild("PortalSpawn")
k(sp)
k(pp)

local ground = cw and cw:FindFirstChild("Decoration") and cw.Decoration:FindFirstChild("Ground")
local meshes = ground and ground:FindFirstChild("Meshes")
if meshes then
    for _,m in ipairs(meshes:GetDescendants()) do
        if m:IsA("BasePart") then
            k(m)
            m.CanCollide = false
        end
    end
end

local function anc(x)
    while x do
        keep[x] = true
        if x == cw then break end
        x = x.Parent
    end
end

anc(sp)
anc(pp)

local surf = Instance.new("Part")
surf.Size = Vector3.new(2000,20,2000)
surf.Position = Vector3.new(0,5,0)
surf.Anchored = true
surf.CanCollide = true
surf.Transparency = 1
surf.Parent = ws

if lp then
    lp.CharacterAdded:Connect(function(c)
        task.wait(0.4)
        local hrp = c:WaitForChild("HumanoidRootPart")
        hrp.CFrame = CFrame.new(0,10,0)
    end)
    if char then
        task.wait(0.4)
        pcall(function() char:WaitForChild("HumanoidRootPart",2).CFrame = CFrame.new(0,10,0) end)
    end
end

local function d(i) if i and i.Parent then pcall(function() i:Destroy() end) end end

local function batch(list, b, w)
    local i=1
    local n=#list
    while i<=n do
        for j=i, math.min(i+b-1,n) do d(list[j]) end
        i=i+b
        task.wait(w)
    end
end

pcall(function()
    if lp then
        local pg = lp:WaitForChild("PlayerGui",2)
        if pg then
            local t={}
            for _,g in ipairs(pg:GetChildren()) do
                if g:IsA("ScreenGui") or g:IsA("SurfaceGui") or g:IsA("BillboardGui") then
                    table.insert(t,g)
                end
            end
            batch(t,30,0.02)
        end
    end
end)

do
    local t={}
    for _,o in ipairs(ws:GetDescendants()) do
        if not keep[o] then
            if o:IsA("ScreenGui") or o:IsA("SurfaceGui") or o:IsA("BillboardGui") then
                table.insert(t,o)
            end
        end
    end
    batch(t,30,0.02)
end

do
    local t={}
    for _,o in ipairs(ws:GetDescendants()) do
        if not keep[o] then
            if o:IsA("MeshPart")
            or o:IsA("SpecialMesh")
            or o:IsA("UnionOperation")
            or o:IsA("Texture")
            or o:IsA("Decal")
            or o:IsA("ParticleEmitter")
            or o:IsA("Beam")
            or o:IsA("Trail")
            or o:IsA("Fire")
            or o:IsA("Smoke")
            or o:IsA("Sparkles")
            or o:IsA("Highlight")
            or o:IsA("SurfaceAppearance") then
                table.insert(t,o)
            end
        end
    end
    batch(t,200,0.02)
end

do
    local t={}
    for _,o in ipairs(ws:GetDescendants()) do
        if not keep[o] then
            if o:IsA("Script") or o:IsA("LocalScript") or o:IsA("ModuleScript") then
                if not o:IsDescendantOf(char) then
                    table.insert(t,o)
                end
            end
        end
    end
    batch(t,100,0.03)
end

do
    local t={}
    for _,o in ipairs(ws:GetDescendants()) do
        if not keep[o] and not o:IsA("BasePart") then
            table.insert(t,o)
        end
    end
    batch(t,200,0.03)
end

do
    local t={}
    for _,o in ipairs(ws:GetChildren()) do
        if not keep[o] then table.insert(t,o) end
    end
    batch(t,20,0.05)
end

do
    local t={}
    for _,v in ipairs(Lighting:GetChildren()) do table.insert(t,v) end
    batch(t,50,0.02)
end

local dis={
"Chat","VoiceChatService","TextChatService","SoundService","MaterialService","BadgeService",
"BrowserService","CSGDictionaryService","CaptureService","ChangeHistoryService","CollectionService",
"CommerceService","ContextActionService","ControllerService","CookiesService","CreatorStoreService",
"Debris","EditableService","EncodingService","EventIngestService","ExperienceAuthService",
"ExperienceNotificationService","ExperienceService","FaceAnimatorService","FacialAnimationStreamingService",
"GamePassService","GamepadService","GenericChallengeService","GroupService","GuiService",
"GuidRegistryService","HapticService","HeapProfilerService","VRService","AnalyticsService",
"AnimationClipProvider","AppLifeCycleObserverService","AppStorageService","AssetService",
"AudioFocusService","AvatarChatService","AvatarCreationService","AvatarEditorService","AvatarSettings"
}

local b={}
for i,n in ipairs(dis) do
    table.insert(b,n)
    if #b>=15 or i==#dis then
        for _,sn in ipairs(b) do
            local ok,svc = pcall(game.GetService,game,sn)
            if ok and svc then
                pcall(function() for _,v in ipairs(svc:GetChildren()) do pcall(function() v:Destroy() end) end end)
                pcall(function() svc.Enabled=false end)
            end
        end
        b={}
        task.wait(0.12)
    end
end

pcall(function() RunService:Set3dRenderingEnabled(false) end)
