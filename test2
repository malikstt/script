local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local ws = workspace
local lp = Players.LocalPlayer
local char = lp and lp.Character

local keep = {}
local function k(x) if x then keep[x]=true end end

local worlds = ws:FindFirstChild("Worlds")
local cw = worlds and worlds:FindFirstChild("Christmas World")

k(ws.Camera)
k(worlds)
k(cw)
k(char)

if cw then
    for _,v in ipairs(cw:GetDescendants()) do
        k(v)
    end
end

local function protectCharacter(c)
    if not c then return end
    k(c)
    for _,v in ipairs(c:GetDescendants()) do k(v) end
end

if char then protectCharacter(char) end
lp.CharacterAdded:Connect(function(c)
    task.wait(0.4)
    protectCharacter(c)
    pcall(function() c:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(0,10,0) end)
end)

local surf = Instance.new("Part")
surf.Size = Vector3.new(2000,20,2000)
surf.Position = Vector3.new(0,5,0)
surf.Anchored=true
surf.CanCollide=true
surf.Transparency=1
surf.Parent=ws

local function isChar(o)
    return lp and lp.Character and (o==lp.Character or o:IsDescendantOf(lp.Character))
end

local function d(i)
    if i and i.Parent and not keep[i] and not isChar(i) then
        pcall(function() i:Destroy() end)
    end
end

local function batch(list,b,w)
    local i=1
    local n=#list
    while i<=n do
        for j=i, math.min(i+b-1,n) do d(list[j]) end
        i=i+b
        task.wait(w)
    end
end

local function collect(pred)
    local t={}
    for _,o in ipairs(ws:GetDescendants()) do
        if pred(o) then table.insert(t,o) end
    end
    return t
end

local pg = lp:FindFirstChild("PlayerGui")
if pg then
    local t={}
    for _,g in ipairs(pg:GetChildren()) do
        if g:IsA("ScreenGui") or g:IsA("SurfaceGui") or g:IsA("BillboardGui") then
            table.insert(t,g)
        end
    end
    batch(t,5,0.4)
end

batch(collect(function(o)
    return (o:IsA("ScreenGui") or o:IsA("SurfaceGui") or o:IsA("BillboardGui"))
end),10,0.3)

task.wait(1)

batch(collect(function(o)
    return (o:IsA("MeshPart") or o:IsA("SpecialMesh") or o:IsA("UnionOperation")
    or o:IsA("Texture") or o:IsA("Decal") or o:IsA("ParticleEmitter") or o:IsA("Beam")
    or o:IsA("Trail") or o:IsA("Fire") or o:IsA("Smoke") or o:IsA("Sparkles")
    or o:IsA("Highlight") or o:IsA("SurfaceAppearance"))
end),40,0.35)

task.wait(0.8)

batch(collect(function(o)
    return (o:IsA("Adornment") or o:IsA("SelectionBox") or o:IsA("SelectionSphere") or o:IsA("ArcHandles"))
end),20,0.3)

task.wait(0.6)

batch(collect(function(o)
    return (o:IsA("Script") or o:IsA("LocalScript") or o:IsA("ModuleScript")) and not o:IsDescendantOf(lp.Character)
end),20,0.6)

task.wait(0.8)

batch(collect(function(o)
    return not o:IsA("BasePart")
end),30,0.5)

task.wait(1)

local t2={}
for _,c in ipairs(ws:GetChildren()) do if not keep[c] then table.insert(t2,c) end end
batch(t2,3,0.7)

task.wait(1)

local t3={}
for _,v in ipairs(Lighting:GetChildren()) do table.insert(t3,v) end
batch(t3,8,0.4)

task.wait(0.6)

local dl={
"Chat","VoiceChatService","TextChatService","SoundService","MaterialService","BadgeService","BrowserService",
"CSGDictionaryService","CaptureService","ChangeHistoryService","CollectionService","CommerceService",
"ContextActionService","ControllerService","CookiesService","CreatorStoreService","Debris","EditableService",
"EncodingService","EventIngestService","ExperienceAuthService","ExperienceNotificationService","ExperienceService",
"FaceAnimatorService","FacialAnimationStreamingService","GamePassService","GamepadService","GenericChallengeService",
"GroupService","GuiService","GuidRegistryService","HapticService","HeapProfilerService","VRService","AnalyticsService",
"AnimationClipProvider","AppLifeCycleObserverService","AppStorageService","AssetService","AudioFocusService",
"AvatarChatService","AvatarCreationService","AvatarEditorService","AvatarSettings"
}

local temp={}
for i,n in ipairs(dl) do
    table.insert(temp,n)
    if #temp>=8 or i==#dl then
        for _,sn in ipairs(temp) do
            local ok,svc=pcall(game.GetService,game,sn)
            if ok and svc then
                pcall(function()
                    for _,v in ipairs(svc:GetChildren()) do
                        if not keep[v] and not isChar(v) then pcall(function() v:Destroy() end) end
                    end
                end)
                pcall(function() svc.Enabled=false end)
            end
        end
        temp={}
        task.wait(0.8)
    end
end

task.wait(0.6)

batch(collect(function(o)
    return (o:IsA("BillboardGui") or o:IsA("SurfaceGui") or o:IsA("ScreenGui")
    or o:IsA("ParticleEmitter") or o:IsA("Beam") or o:IsA("Trail") or o:IsA("Texture")
    or o:IsA("Decal") or o:IsA("SpecialMesh") or o:IsA("MeshPart") or o:IsA("UnionOperation")
    or o:IsA("Fire") or o:IsA("Smoke") or o:IsA("Sparkles") or o:IsA("Highlight")
    or o:IsA("SurfaceAppearance"))
end),50,0.4)

task.wait(0.6)

pcall(function() RunService:Set3dRenderingEnabled(false) end)
