-- ===== DAMAGE TAB =====

local DamageTab = Window:CreateTab("Damage", 4483362458)

local damageTarget = nil
local damageAmount = 10
local damageDelay = 0.5
local damageLoop = false
local damageAllLoop = false

-- try common damage method
local function dealDamage(plr, amount)
    if plr and plr.Character then
        local hum = plr.Character:FindFirstChildOfClass("Humanoid")
        if hum then
            pcall(function()
                hum:TakeDamage(amount)
            end)
        end
    end
end

-- ===== TARGET SELECT =====
local function getPlayerNames()
    local t = {}
    for _,p in ipairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then
            table.insert(t, p.Name)
        end
    end
    return t
end

local DamageDropdown = DamageTab:CreateDropdown({
    Name = "Target Player",
    Options = getPlayerNames(),
    CurrentOption = {},
    Callback = function(opt)
        damageTarget = Players:FindFirstChild(opt[1])
    end
})

Players.PlayerAdded:Connect(function()
    DamageDropdown:Refresh(getPlayerNames())
end)

Players.PlayerRemoving:Connect(function()
    DamageDropdown:Refresh(getPlayerNames())
end)

-- ===== DAMAGE SLIDER =====
DamageTab:CreateSlider({
    Name = "Damage Amount",
    Range = {10,1000},
    Increment = 10,
    CurrentValue = 10,
    Callback = function(v)
        damageAmount = v
    end
})

-- ===== DELAY SLIDER =====
DamageTab:CreateSlider({
    Name = "Damage Delay",
    Range = {0.5,1},
    Increment = 0.05,
    CurrentValue = 0.5,
    Callback = function(v)
        damageDelay = v
    end
})

-- ===== DAMAGE TARGET LOOP =====
DamageTab:CreateToggle({
    Name = "Damage Selected Player",
    CurrentValue = false,
    Callback = function(v)
        damageLoop = v
    end
})

task.spawn(function()
    while true do
        if damageLoop and damageTarget then
            dealDamage(damageTarget, damageAmount)
            task.wait(damageDelay)
        else
            task.wait()
        end
    end
end)

-- ===== DAMAGE ALL =====
DamageTab:CreateToggle({
    Name = "Damage All Players",
    CurrentValue = false,
    Callback = function(v)
        damageAllLoop = v
    end
})

task.spawn(function()
    while true do
        if damageAllLoop then
            for _,p in ipairs(Players:GetPlayers()) do
                if p ~= LocalPlayer then
                    dealDamage(p, damageAmount)
                    task.wait(0.5)
                end
            end
        else
            task.wait()
        end
    end
end)
