-- ðŸŒˆ Rayfield
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
    Name = "Teleport Control",
    LoadingTitle = "Teleport UI",
    LoadingSubtitle = "Rayfield",
})

local Tab = Window:CreateTab("Teleport", 4483362458)

-- Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

--------------------------------------------------
-- ðŸš« BLACKLIST (ADD NAMES HERE)
--------------------------------------------------
local BLACKLIST = {
    ["YourNameHere"] = true,
    ["FriendYouDontWant"] = true,
}

--------------------------------------------------
-- STATES
--------------------------------------------------
local TP_CYCLE = false
local TP_STICKY = false

--------------------------------------------------
-- ðŸ”¤ GET SORTED + FILTERED PLAYER LIST
--------------------------------------------------
local function getValidPlayers()
    local list = {}

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer
            and not BLACKLIST[player.Name]
            and player.Character
            and player.Character:FindFirstChild("HumanoidRootPart") then
            table.insert(list, player)
        end
    end

    table.sort(list, function(a, b)
        return a.Name:lower() < b.Name:lower()
    end)

    return list
end

--------------------------------------------------
-- ðŸš¶â€â™‚ï¸ MODE 1: CYCLE (always goes next)
--------------------------------------------------
task.spawn(function()
    while true do
        if TP_CYCLE then
            local char = LocalPlayer.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")

            if root then
                local players = getValidPlayers()
                for _, player in ipairs(players) do
                    if not TP_CYCLE then break end
                    local targetRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                    if targetRoot then
                        root.CFrame = targetRoot.CFrame + Vector3.new(0, 3, 0)
                        task.wait(0.15)
                    end
                end
            end
        end
        task.wait(0.1)
    end
end)

--------------------------------------------------
-- ðŸŽ¯ MODE 2: STICKY (only switches if target gone)
--------------------------------------------------
task.spawn(function()
    local currentTarget = nil

    while true do
        if TP_STICKY then
            local char = LocalPlayer.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")

            if root then
                -- validate current target
                if not currentTarget
                or not currentTarget.Parent
                or BLACKLIST[currentTarget.Name]
                or not currentTarget.Character
                or not currentTarget.Character:FindFirstChild("HumanoidRootPart") then

                    currentTarget = nil
                    local players = getValidPlayers()
                    currentTarget = players[1] -- alphabetically first valid
                end

                if currentTarget and currentTarget.Character then
                    local targetRoot = currentTarget.Character:FindFirstChild("HumanoidRootPart")
                    if targetRoot then
                        root.CFrame = targetRoot.CFrame + Vector3.new(0, 3, 0)
                    end
                end
            end
        end
        task.wait(0.15)
    end
end)

--------------------------------------------------
-- ðŸ§© UI TOGGLES
--------------------------------------------------
Tab:CreateToggle({
    Name = "Cycle Teleport (A â†’ Z)",
    CurrentValue = false,
    Callback = function(v)
        TP_CYCLE = v
        if v then TP_STICKY = false end
    end
})

Tab:CreateToggle({
    Name = "Sticky Teleport (Until Gone)",
    CurrentValue = false,
    Callback = function(v)
        TP_STICKY = v
        if v then TP_CYCLE = false end
    end
})
