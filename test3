repeat task.wait() until game:IsLoaded()

getgenv().running = not getgenv().running

local Players = game:GetService("Players")
local RS = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local player = Players.LocalPlayer

local Remote = require(RS.Shared.Framework.Network.Remote)
local LocalDataModule = require(RS.Client.Framework.Services.LocalData)
local PhysicalItem = require(RS.Client.Effects.PhysicalItem)
local RemoteEvent = RS.Shared.Framework.Network.Remote.RemoteEvent
local PetsModule = require(RS.Shared.Data.Pets)

local function getLocalData()
    return LocalDataModule:Get()
end

task.spawn(function()
    while true do
        local char = player.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        if hrp then
            hrp.CFrame = CFrame.new(132.47, 9.73, 97.12)
        end
        task.wait(60)
    end
end)

pcall(function()
    require(RS.Client.Effects.HatchEgg).Play = function() end
end)

task.spawn(function()
    while true do
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
        task.wait()
    end
end)

task.spawn(function()
    for _, v in ipairs(workspace:GetDescendants()) do
        if v:IsA("Texture") or v:IsA("Decal") then
            v:Destroy()
        end
    end
end)

task.spawn(function()
    while getgenv().running do
        local data = getLocalData()
        if data and data.Powerups then
            for name, amount in pairs(data.Powerups) do
                if amount and amount > 0 then
                    Remote:FireServer("UseGift", name, amount)
                    task.wait(25)
                end
            end
        end
        task.wait(1)
    end
end)

local pots = {
    {"UsePotion", "Speed", 7, 1},
    {"UsePotion", "Lucky", 7, 1},
    {"UsePotion", "Mythic", 7, 1},
    {"UsePotion", "Egg Elixir", 1, 1},
    {"UsePotion", "Infinity Elixir", 1, 1},
    {"UsePotion", "Festive Elixir", 4, 1},
    {"UsePotion", "Festive Infinity Elixir", 1, 1},
    {"UsePotion", "Ultra Infinity Elixir", 1, 1},
}

local e = 60

if getgenv().running then
    RunService:BindToRenderStep("PotionSpam", Enum.RenderPriority.First.Value, function()
        for i = 1, e do
            for _, args in ipairs(pots) do
                RemoteEvent:FireServer(unpack(args))
            end
        end
    end)
else
    RunService:UnbindFromRenderStep("PotionSpam")
end

local FORCE_AUTODELETE = {
    ["Frutiger User"] = true,
    ["Bubble Doggy"] = true,
    ["Mine Sweeper"] = true,
    ["Purble Vision"] = true,
    ["Aero Koi"] = true,
}

task.spawn(function()
    while true do
        local data = getLocalData()
        if data and data.Pets and data.AutoDelete then
            for _, pet in pairs(data.Pets) do
                if pet and pet.Name and FORCE_AUTODELETE[pet.Name] and not data.AutoDelete[pet.Name] then
                    RemoteEvent:FireServer("ToggleAutoDelete", pet.Name)
                    task.wait(0.1)
                end
            end
        end
        task.wait(5)
    end
end)
