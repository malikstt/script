local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local LocalPlayer = Players.LocalPlayer

local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
	Name = "TP / Click",
	LoadingTitle = "Rayfield",
	LoadingSubtitle = "Toggle",
	ConfigurationSaving = {Enabled = false}
})

local Tab = Window:CreateTab("Main", 4483362458)

local excluded = "yasindk066"
local delayScale = 0.5

local spamClick = false
local tpSequential = false
local tpRandom = false

local seqIndex = 1
local seqTarget = nil

local clickConn
local seqConn
local randThread

local function getSortedPlayers()
	local t = {}
	for _,p in ipairs(Players:GetPlayers()) do
		if p ~= LocalPlayer
		and p.Name ~= excluded
		and p.Character
		and p.Character:FindFirstChild("Humanoid")
		and p.Character.Humanoid.Health > 0 then
			table.insert(t,p)
		end
	end
	table.sort(t,function(a,b)
		return a.Name:lower() < b.Name:lower()
	end)
	return t
end

local function tpTo(plr)
	local c = LocalPlayer.Character
	local tc = plr.Character
	if not c or not tc then return end
	local hrp = c:FindFirstChild("HumanoidRootPart")
	local thrp = tc:FindFirstChild("HumanoidRootPart")
	if not hrp or not thrp then return end
	task.wait(math.random() * delayScale)
	hrp.CFrame = thrp.CFrame * CFrame.new(0,0,-0.5)
end

Tab:CreateToggle({
	Name = "Virtual Spam Click",
	CurrentValue = false,
	Callback = function(v)
		spamClick = v
		if v then
			clickConn = RunService.Heartbeat:Connect(function()
				VirtualUser:Button1Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
				VirtualUser:Button1Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
			end)
		else
			if clickConn then clickConn:Disconnect() clickConn = nil end
		end
	end
})

Tab:CreateToggle({
	Name = "TP Players Alphabetical",
	CurrentValue = false,
	Callback = function(v)
		tpSequential = v
		seqIndex = 1
		seqTarget = nil

		if v then
			seqConn = RunService.Heartbeat:Connect(function()
				local list = getSortedPlayers()
				if #list == 0 then return end

				if not seqTarget
				or not seqTarget.Character
				or seqTarget.Character.Humanoid.Health <= 0 then
					seqTarget = list[seqIndex]
					seqIndex += 1
					if seqIndex > #list then seqIndex = 1 end
				end

				if seqTarget then
					tpTo(seqTarget)
				end
			end)
		else
			if seqConn then seqConn:Disconnect() seqConn = nil end
		end
	end
})

Tab:CreateToggle({
	Name = "TP Random Player",
	CurrentValue = false,
	Callback = function(v)
		tpRandom = v
		if v then
			randThread = task.spawn(function()
				while tpRandom do
					local list = getSortedPlayers()
					if #list > 0 then
						tpTo(list[math.random(#list)])
					end
					task.wait(delayScale)
				end
			end)
		else
			tpRandom = false
		end
	end
})
