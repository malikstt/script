local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Network = ReplicatedStorage.Shared.Framework.Network.Remote.RemoteEvent
local LocalData = require(ReplicatedStorage.Client.Framework.Services.LocalData)
local PetsModule = require(ReplicatedStorage.Shared.Data.Pets)

-- delete steps (highest ‚Üí lowest)
local DELETE_AMOUNTS = {
    1_000_000,
    100_000,
    10_000,
    1_000,
    100,
    10,
    1
}

local KEEP_PETS = {
    ["Nexus"] = true,
    ["Serendipity"] = true,
    ["Hyperwave Kitty"] = true,
    ["Leviathan Tophat"] = true,
    ["OG New Year's Champion"] = true,
    ["New Year's Champion"] = true,
    ["Symphonic Hieromphant"] = true,
    ["Bubble Circus Show"] = true,
    ["Gigantic Spitty"] = true,
    ["King Spitty"] = true,
    ["Painted Daze"] = true,
}

local KEEP_XL_PETS = {
    ["Nexus"] = true,
    ["Hyperwave Kitty"] = true,
}

local function isSecretPet(pet)
    local info = PetsModule[pet.Name]
    return info and info.Rarity == "Secret"
end

local function deletePetFully(petId)
    for _, amount in ipairs(DELETE_AMOUNTS) do
        Network:FireServer("DeletePet", petId, amount, false)
        task.wait(0.03)
    end
end

task.spawn(function()
    while true do
        local data = LocalData:Get()
        if data and data.Pets then
            for _, pet in pairs(data.Pets) do
                if not pet.Id then continue end

                local isSecret = isSecretPet(pet)

                -- üî¥ DELETE ALL NON-SECRETS
                if not isSecret then
                    deletePetFully(pet.Id)
                    print("[DELETED NON-SECRET] " .. pet.Name)
                    continue
                end

                -- üü¢ KEEP LIST
                if KEEP_PETS[pet.Name] then
                    print("[SKIPPED SECRET] " .. pet.Name)
                    continue
                end

                if pet.XL and KEEP_XL_PETS[pet.Name] then
                    print("[SKIPPED XL SECRET] " .. pet.Name)
                    continue
                end

                -- ‚ùå DELETE UNWANTED SECRETS
                deletePetFully(pet.Id)
                print("[DELETED SECRET] " .. pet.Name)
            end
        end
        task.wait(5)
    end
end)
